# Results

## lr=1e-4, batch-size=8, epoch=5, imdb-5000 
- ACC ~0.5
The model will stuck at certain loss after a few steps and predict only one label, <br>
leading to 0.5 or less accuracy for binary classification.

## lr=5e-5, batch-size=8, epoch=5, imdb-5000 
- ACC: 0.8942 (torch-admaw)
- ACC: 0.906 (transformers-admaw)

# Check example
```
# Demo one example
print("Demo of a prompt engineered sample:")
wrapped_example = prompt_template.wrap_one_example(dataset['train'][0])
print(wrapped_example)
print("Demo of a prompt tokenized sample:")
tokenized_example = wrapped_tokenizer.tokenize_one_example(wrapped_example, teacher_forcing=False)
print(tokenized_example)
print(tokenizer.convert_ids_to_tokens(tokenized_example['input_ids']))

Demo of a prompt engineered sample:
[[{'text': "POSSIBLE SPOILERS<br /><br />The Spy Who Shagged Me is a muchly overrated and over-hyped sequel. International Man of Mystery came straight out of the blue. It was a lone star that few people had heard of. But it was stunningly original, had sophisticated humour and ample humour, always kept in good taste, and had a brilliant cast. The Spy Who Shagged Me was a lot more commercially advertised and hyped about.<br /><br />OK I'll admit, the first time I saw this film I thought it was very funny, but it's only after watching it two or three times that you see all the flaws. The acting was OK, but Heather Graham cannot act. Her performance didn't seem very convincing and she wasn't near as good as Liz Hurley was in the first one. Those characters who bloomed in the first one, (Scott Evil, Number 2 etc.) are thrown into the background hear and don't get many stand-alone scenes. The film is simply overrun with cameos.<br /><br />In particular, I hated the way they totally disregarded some of the scenes in IMOM. When they killed off Vanessa at the start and had Basil sat that he knew she was a fembot all along. What was the point of that? They killed off Number 2 in the first one, and now they bring him back with no explanation whatsoever. This is supposed to be a spy-spoof, I don't think any of the characters even hold a gun in the film. It just goes on a trail, further and further away from the point.<br /><br />The new characters are very unwelcome. The whole Mini-Me `make fun of my size' joke gets old very quickly. Fat Bastard is just a lame excuse for gross-out humour. In total there's about two or three good jokes. The rest are either tasteless or rehashed from IMOM.<br /><br />If this were the first movie of the series then I'd probably be easier on it. But the series started on a note of dry wit and then plummeted down to a level of gross out humour. So I say, only watch this film if you haven't seen its predecessor, because The Spy Who Shagged Me is one ultimate disappointment.", 'loss_ids': 0, 'shortenable_ids': 1}, {'text': ' It was', 'loss_ids': 0, 'shortenable_ids': 0}, {'text': '<mask>', 'loss_ids': 1, 'shortenable_ids': 0}], {'guid': 0, 'label': 0}]

Demo of a prompt tokenized sample:
{'input_ids': [101, 2825, 27594, 2545, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 1996, 8645, 2040, 21146, 15567, 2033, 2003, 1037, 2172, 2135, 2058, 9250, 1998, 2058, 1011, 1044, 18863, 2094, 8297, 1012, 2248, 2158, 1997, 6547, 2234, 3442, 2041, 1997, 1996, 2630, 1012, 2009, 2001, 1037, 10459, 2732, 2008, 2261, 2111, 2018, 2657, 1997, 1012, 2021, 2009, 2001, 14726, 2135, 2434, 1010, 2018, 12138, 17211, 1998, 20851, 17211, 1010, 2467, 2921, 1999, 2204, 5510, 1010, 1998, 2018, 1037, 8235, 3459, 1012, 1996, 8645, 2040, 21146, 15567, 2033, 2001, 1037, 2843, 2062, 11088, 17099, 1998, 1044, 18863, 2094, 2055, 1012, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 7929, 1045, 1005, 2222, 6449, 1010, 1996, 2034, 2051, 1045, 2387, 2023, 2143, 1045, 2245, 2009, 2001, 2200, 6057, 1010, 2021, 2009, 1005, 1055, 2069, 2044, 3666, 2009, 2048, 2030, 2093, 2335, 2008, 2017, 2156, 2035, 1996, 21407, 1012, 1996, 3772, 2001, 7929, 1010, 2021, 9533, 5846, 3685, 2552, 1012, 2014, 2836, 2134, 1005, 1056, 4025, 2200, 13359, 1998, 2016, 2347, 1005, 1056, 2379, 2004, 2204, 2004, 9056, 25124, 2001, 1999, 1996, 2034, 2028, 1012, 2216, 3494, 2040, 13426, 2098, 1999, 1996, 2034, 2028, 1010, 1006, 3660, 4763, 1010, 2193, 1016, 4385, 1012, 1007, 2024, 6908, 2046, 1996, 4281, 2963, 1998, 2123, 1005, 1056, 2131, 2116, 3233, 1011, 2894, 5019, 1012, 1996, 2143, 2003, 3432, 24672, 2007, 12081, 2015, 1012, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 1999, 3327, 1010, 1045, 6283, 1996, 2126, 2027, 6135, 27770, 2098, 2070, 1997, 1996, 5019, 1999, 10047, 5358, 1012, 2043, 2027, 2730, 2125, 13226, 2012, 1996, 2707, 1998, 2018, 14732, 2938, 2008, 2002, 2354, 2016, 2001, 1037, 10768, 13344, 2102, 2035, 2247, 1012, 2054, 2001, 1996, 2391, 1997, 2008, 1029, 2027, 2730, 2125, 2193, 1016, 1999, 1996, 2034, 2028, 1010, 1998, 2085, 2027, 3288, 2032, 2067, 2007, 2053, 7526, 18971, 1012, 2023, 2003, 4011, 2000, 2022, 1037, 8645, 1011, 11867, 21511, 1010, 1045, 2123, 1005, 1056, 2228, 2151, 1997, 1996, 3494, 2130, 2907, 1037, 3282, 1999, 1996, 2143, 1012, 2009, 2074, 3632, 2006, 1037, 4446, 1010, 2582, 1998, 2582, 2185, 2013, 1996, 2391, 1012, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 1996, 2047, 3494, 2024, 2200, 4895, 8545, 22499, 4168, 1012, 1996, 2878, 7163, 1011, 2033, 1036, 2191, 4569, 1997, 2026, 2946, 1005, 8257, 4152, 2214, 2200, 2855, 1012, 6638, 8444, 2003, 2074, 1037, 20342, 8016, 2005, 7977, 1011, 2041, 17211, 1012, 1999, 2561, 2045, 1005, 1055, 2055, 2048, 2030, 2093, 2204, 13198, 1012, 1996, 2717, 2024, 2593, 5510, 3238, 2030, 2128, 14949, 9072, 2013, 10047, 5358, 1012, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 2065, 2023, 2020, 1996, 2034, 3185, 1997, 1996, 2186, 2059, 1045, 1005, 1040, 2763, 2022, 6082, 2006, 2009, 1012, 2021, 1996, 2186, 2318, 2006, 1037, 3602, 1997, 4318, 15966, 1998, 2059, 22088, 11368, 2098, 2091, 2000, 1037, 2504, 1997, 7977, 2041, 17211, 1012, 2061, 1045, 2360, 1010, 2069, 3422, 2023, 2143, 2065, 2017, 4033, 1005, 1056, 2464, 2049, 8646, 1010, 2138, 1996, 8645, 2040, 21146, 15567, 2033, 2003, 2028, 7209, 10520, 1012, 2009, 2001, 103, 102, 0, 0, 0, 0], 'loss_ids': [-100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -100, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0]}
['[CLS]', 'possible', 'spoil', '##ers', '<', 'br', '/', '>', '<', 'br', '/', '>', 'the', 'spy', 'who', 'sha', '##gged', 'me', 'is', 'a', 'much', '##ly', 'over', '##rated', 'and', 'over', '-', 'h', '##ype', '##d', 'sequel', '.', 'international', 'man', 'of', 'mystery', 'came', 'straight', 'out', 'of', 'the', 'blue', '.', 'it', 'was', 'a', 'lone', 'star', 'that', 'few', 'people', 'had', 'heard', 'of', '.', 'but', 'it', 'was', 'stunning', '##ly', 'original', ',', 'had', 'sophisticated', 'humour', 'and', 'ample', 'humour', ',', 'always', 'kept', 'in', 'good', 'taste', ',', 'and', 'had', 'a', 'brilliant', 'cast', '.', 'the', 'spy', 'who', 'sha', '##gged', 'me', 'was', 'a', 'lot', 'more', 'commercially', 'advertised', 'and', 'h', '##ype', '##d', 'about', '.', '<', 'br', '/', '>', '<', 'br', '/', '>', 'ok', 'i', "'", 'll', 'admit', ',', 'the', 'first', 'time', 'i', 'saw', 'this', 'film', 'i', 'thought', 'it', 'was', 'very', 'funny', ',', 'but', 'it', "'", 's', 'only', 'after', 'watching', 'it', 'two', 'or', 'three', 'times', 'that', 'you', 'see', 'all', 'the', 'flaws', '.', 'the', 'acting', 'was', 'ok', ',', 'but', 'heather', 'graham', 'cannot', 'act', '.', 'her', 'performance', 'didn', "'", 't', 'seem', 'very', 'convincing', 'and', 'she', 'wasn', "'", 't', 'near', 'as', 'good', 'as', 'liz', 'hurley', 'was', 'in', 'the', 'first', 'one', '.', 'those', 'characters', 'who', 'bloom', '##ed', 'in', 'the', 'first', 'one', ',', '(', 'scott', 'evil', ',', 'number', '2', 'etc', '.', ')', 'are', 'thrown', 'into', 'the', 'background', 'hear', 'and', 'don', "'", 't', 'get', 'many', 'stand', '-', 'alone', 'scenes', '.', 'the', 'film', 'is', 'simply', 'overrun', 'with', 'cameo', '##s', '.', '<', 'br', '/', '>', '<', 'br', '/', '>', 'in', 'particular', ',', 'i', 'hated', 'the', 'way', 'they', 'totally', 'disregard', '##ed', 'some', 'of', 'the', 'scenes', 'in', 'im', '##om', '.', 'when', 'they', 'killed', 'off', 'vanessa', 'at', 'the', 'start', 'and', 'had', 'basil', 'sat', 'that', 'he', 'knew', 'she', 'was', 'a', 'fe', '##mbo', '##t', 'all', 'along', '.', 'what', 'was', 'the', 'point', 'of', 'that', '?', 'they', 'killed', 'off', 'number', '2', 'in', 'the', 'first', 'one', ',', 'and', 'now', 'they', 'bring', 'him', 'back', 'with', 'no', 'explanation', 'whatsoever', '.', 'this', 'is', 'supposed', 'to', 'be', 'a', 'spy', '-', 'sp', '##oof', ',', 'i', 'don', "'", 't', 'think', 'any', 'of', 'the', 'characters', 'even', 'hold', 'a', 'gun', 'in', 'the', 'film', '.', 'it', 'just', 'goes', 'on', 'a', 'trail', ',', 'further', 'and', 'further', 'away', 'from', 'the', 'point', '.', '<', 'br', '/', '>', '<', 'br', '/', '>', 'the', 'new', 'characters', 'are', 'very', 'un', '##we', '##lco', '##me', '.', 'the', 'whole', 'mini', '-', 'me', '`', 'make', 'fun', 'of', 'my', 'size', "'", 'joke', 'gets', 'old', 'very', 'quickly', '.', 'fat', 'bastard', 'is', 'just', 'a', 'lame', 'excuse', 'for', 'gross', '-', 'out', 'humour', '.', 'in', 'total', 'there', "'", 's', 'about', 'two', 'or', 'three', 'good', 'jokes', '.', 'the', 'rest', 'are', 'either', 'taste', '##less', 'or', 're', '##has', '##hed', 'from', 'im', '##om', '.', '<', 'br', '/', '>', '<', 'br', '/', '>', 'if', 'this', 'were', 'the', 'first', 'movie', 'of', 'the', 'series', 'then', 'i', "'", 'd', 'probably', 'be', 'easier', 'on', 'it', '.', 'but', 'the', 'series', 'started', 'on', 'a', 'note', 'of', 'dry', 'wit', 'and', 'then', 'plum', '##met', '##ed', 'down', 'to', 'a', 'level', 'of', 'gross', 'out', 'humour', '.', 'so', 'i', 'say', ',', 'only', 'watch', 'this', 'film', 'if', 'you', 'haven', "'", 't', 'seen', 'its', 'predecessor', ',', 'because', 'the', 'spy', 'who', 'sha', '##gged', 'me', 'is', 'one', 'ultimate', 'disappointment', '.', 'it', 'was', '[MASK]', '[SEP]', '[PAD]', '[PAD]', '[PAD]', '[PAD]']
```
